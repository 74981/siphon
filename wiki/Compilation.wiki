#summary Compilation guide.
#labels Phase-Implementation

= Introduction =

This article describes the steps to generate Siphon.

=PjSIP Compilation=

==Check out code==
Get [http://pjsip.org PjSIP] from subversion repository:

{{{
svn checkout http://svn.pjsip.org/repos/pjproject/trunk pjproject
}}}

==Compilation==
Configure pjsip without codec except G711 and GSM. For the moment, we don't use sound device.
{{{
./aconfigure --host=arm-apple-darwin8 \
  --disable-sound \
  --disable-speex-aec --disable-speex-codec \
  --disable-l16-codec --disable-g722-codec  --disable-ilbc-codec
}}}

_We need to add GSM codec, because when the pjmedia-codec library is build, the *ar* command needs object file to exit without failure._

==Media device for ipod==

===pjMedia===
Download [http://siphon.googlecode.com/files/ipodsound.c ipodsound.c], and save in _pjmedia/src/pjmedia_ directory.

Complete _config.h_ file in pjmedia/include/pjmedia at line 59 with:
{{{
/** Constant for AudioQueue sound backend. */
#define PJMEDIA_SOUND_IPOD_SOUND	    3
}}}

===Configuration===
Complete _aconfigure.ac_ file at line 370 with:
{{{
  arm-apple-darwin*)
	LIBS="$LIBS -framework CoreAudio -framework CoreFoundation -framework AudioToolbox"
	ac_pjmedia_snd=ipod
	AC_MSG_RESULT([Checking sound device backend... AudioQueue])
	;;
}}}

Generate configuration script
{{{
autoconf aconfigure.ac > aconfigure
}}}

Complete _os-auto.mak.in_ at line 92 with:
{{{
#
# iPod/iPhone
#
ifeq ($(AC_PJMEDIA_SND),ipod)
export SOUND_OBJS = ipodsound.o
export CFLAGS += -DPJMEDIA_SOUND_IMPLEMENTATION=PJMEDIA_SOUND_IPOD_SOUND
endif
}}}

Re-run configuration step with sound enabled:
{{{
./aconfigure --host=arm-apple-darwin8 \
  --disable-speex-aec --disable-speex-codec \
  --disable-l16-codec --disable-g722-codec  --disable-ilbc-codec
}}}